ブラウザ機能
===

SWATHubはクロスプラットフォームのWebアプリを自動化させる機能を提供しています。

### Webエレメントのセレクター

 Webアプリを操作するために、ボタンやテキストボックスなどの操作可能のエレメントをセレクターでローケーティングすることが必要です。このWebエレメントのセレクターは下記のJSONオブジェクトで定義します。


セレクターの例です。
```json
{
  "frame": {
    "name": "mainFrame"
  },
  "css": "button.ui-button-success",
  "text": "Submit"
}
```

ローケーティング情報は下記のキーを持つJSONのMAPです。
* `frame`：エレメントが所属するフレームの定義です。フレームに所属しない場合に、この定義は不要です。
  * `name`：フレームのname属性。
  * `id`：フレームのID属性。
  * `css`：メインコンテンツにフレームのCSSセレクター。
  * `handle`：`-`を区切った数値を使ってフレームのDOM順番で定義した番号。例えば、`1-3`はルートの配下の1番目の子供フレームの配下の3番目の子供フレームを意味します。
* `id`: エレメントのid属性。
* `name`：エレメントのname属性。
* `css`：エレメントのCSSセレクター。
* `text`：複数エレメントの候補がある場合に、対象を絞るテキストマッチングです。
* `index`：複数エレメントの候補がある場合に、対象を絞るインデックスマッチングです。`1`からの整数です。

ブラウザの開発ツールから必要な情報を取得して、JSONを組み込むことができますが、[SWATHubブラウザ拡張機能](../manual/robot_web_inspector)の利用は推奨します。

クリック
---

Webエレメントをマウスクリックします。

#### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。
| ボタン  | クリックのボタン。<br>`left`、`right`を使用します。
| タイプ  | クリックのタイプ。`single`、`double`を使用します。

#### 出力結果

なし

ホーバー
---

Webエレメントをマウスホーバーします。

#### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。

#### 出力結果

なし

セレクト
---

セレクト型（プルダウン）のWebエレメントを選択します。

#### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。
| 選択項目  | 選択項目です。タイプによってテキストもしくは順番（1から）で定義します。<br>複数の場合に「,」区切りで複数項目を記述します。<br>例えば、`car,bike,ship`は三つのvalueの項目を選択します。<br>`1,3`は1番目と3番面の項目を選択します。
| タイプ  | 選択のタイプ、`text`と`index`２種類を対応します。

#### 出力結果

なし

タイプ
---

Webエレメントにテキストを記入します。

#### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。
| テキスト  | 記入するテキスト。<br>`#{TAB}`、`#{UP}`、`#{ENTER}`などの特殊キーが利用可能です。

#### 出力結果

なし

ドラッグ＆ドロップ
---

Webエレメントをドラッグ＆ドロップします。

#### 输入参数

| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。
| ドロップ先 | ドラッグ元を原点にしたドロップ先の位置。<br>`[x,y]`で記述、例えば`[100,0]`は右100pxのところにドロップを意味。

#### 出力結果

なし

要素チェック
---

Webアプリに指定した要素が存在するかどうかをチェックします。

#### 入力引数
| 引数 | 説明
| ---- | ----
| セレクター  | [Webエレメントのセレクター](#Webエレメントのセレクター)。
| 変数名 | 結果（`true`もしく`false`）を格納する変数名。

#### 出力結果
なし

Webで待つ
---

現在のブラウザセッションのウィンドウ内で短時間（秒）もしくは画面の条件の満たしを待ちます<sup>1</sup>。

#### 入力引数
| 引数 | 説明
| ---- | ----
| 時間/タイムアウト（秒）   | 待ち時間。
| 終了条件 | 終了条件。<br>[マッチングルール](rule_matching)を使用します。指定しない場合に`[]`を使用します。

#### 出力結果
なし

?> 1. 時間と条件を両方指定する場合に、指定した時間内に条件の満たしを待ちします。

アサーション
---

現在のウィンドウの画面内容を検証します。条件を満たす場合に、ステップが正常終了、後続のステップが実行されます。満たさない場合に、検証エラーが発生します。

#### 入力引数
| 引数 | 説明
| ---- | ----
| マッチングルール | 検証のための条件を定義するルール。<br>[マッチングルール](rule_matching)を使用します。指定しない場合に`[]`を使用します。

#### 出力結果
なし

Webスクレイピング
---

アクティブのウィンドウ画面から複雑なデータを大量に取得します。

#### 入力引数
| 引数 | 説明
| ---- | ----
| ルール     | 取得先と出力データを定義するルール。

ルールは下記のキーを持つJSONのMAPです。

* `frame` (省略可)：ターゲットフレームの定義です。フレームに所属しない場合に、この定義は不要です。
  * `name`：フレームのname属性。
  * `id`：フレームのID属性。
  * `css`：メインコンテンツにフレームのCSSセレクター。
  * `handle`：`-`を区切った数値を使ってフレームのDOM順番で定義した番号。例えば、`1-3`はルートの配下の1番目の子供フレームの配下の3番目の子供フレームを意味します。
* `opts`: Webスクレーピングルール<sup>1</sup>、取得先と出力データ両方を定義します。

下記はルールのサンプルです。
```json
{
  "frame": {
    "name": "content_iframe"
  },
  "opts": {
    "input_value": {
      "selector": "input[name=input_enable]",
      "attr": "value"
    },
    "link_href": {
      "selector": "#link",
      "attr": "href"
    }
  }
}
```

?> 1. Webスクレーピングルールは[SWATHubブラウザ拡張機能](../manual/robot_web_inspector#Webスクレイピングルール取得)で取得することが可能です。
#### 出力結果

Webスクレーピングルールに定義されたJSONオブジェクトの構造の取得データ。
