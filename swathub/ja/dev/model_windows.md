Windowsモデル
===

Windowsモデルは操作対象のWindowsアプリケーションに対してモデル化し、中にアプリケーションウィンドウに対する操作をエミュレートする操作を定義するものです。[Microsoft UI Automation](https://docs.microsoft.com/en-us/windows/win32/winauto/entry-uiauto-win32)を利用することで、Win32、MFC、WPF、Metro UIなど各種実装のWindowsアプリケーションを対応します。

モデル構築
---

SWATHubではモデルキャプチャーつルーを利用して、Windowsアプリケーションのモデルファイルを取得できます。それをインポートした後に、一連の操作コマンドを定義します。詳細について、[マニュアル](../manual/design_model#windowsモデル)を参照してください。

### Windowsアクションコマンド

WIndowsオペレーションは一連のWindowsアクションコマンドで定義しています。Windowsオペレーションの実行時にそれらのWindowsアクションコマンドは順番に実施します。下記は現在サポートしているWindowsアクションコマンドです。

#### クリック

Windowsコントロールをマウスクリックします。

##### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Windowsコントロールのセレクター](#Windowsコントロールのセレクター)。
| ボタン  | クリックのボタン。<br>`left`、`middle`、`right`を使用します。
| タイプ  | クリックのタイプ。`single`、`double`を使用します。

##### 出力結果

なし

#### ホーバー

Windowsコントロールをマウスホーバーします。

##### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Windowsコントロールのセレクター](#Windowsコントロールのセレクター)。

##### 出力結果

なし

#### タイプ
---

Windowsコントロールにテキストを記入します。

##### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Windowsコントロールのセレクター](#Windowsコントロールのセレクター)。
| テキスト  | 記入するテキスト。<br>`#{TAB}`、`#{UP}`、`#{ENTER}`などの特殊キーが利用可能です。

##### 出力結果

なし

#### テキスト取得

Windowsコントロールからテキストを取得します。このテキストは記入した内容もしくは表示のラベルです。

##### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Windowsコントロールのセレクター](#Windowsコントロールのセレクター)。

##### 出力結果

取得したテキスト文字列

#### フォーカス

Windowsコントロールをアクティブします。

##### 入力引数

| 引数 | 説明
| ---- | ----
| セレクター  | [Windowsコントロールのセレクター](#Windowsコントロールのセレクター)。

##### 出力結果

なし

#### キータイプ

アクティブのデスクトップエレメントに対して、キーをタイプします。

##### 入力引数

| 引数 | 説明
| ---- | ----
| テキスト  | 特殊キー以外のキー<sup>1</sup>のリスト。<br>複数キーが存在する場合に、順番にタイプします。
| 修飾キー | （省略可）テキストと組み合わせる特殊キー<sup>2</sup>。<br>例えば`SHIFT`、`ALT+CTRL`など。

##### 出力結果

なし

?> 1. 現在対応している特殊キーは下記になります：`#{BACK}`、`#{DELETE}`、`#{ENTER}`、`#{TAB}`、`#{ESCAPE}`、`#{UP}`、`#{DOWN}`、`#{RIGHT}`、`#{LEFT}`、`#{HOME}`、`#{END}`、`#{PAGEUP}`、`#{PAGEDOWN}`、`#{F1}`、`#{F2}`、`#{F3}`、`#{F4}`、`#{F5}`、`#{F6}`、`#{F7}`、`#{F8}`、`#{F9}`、`#{F10}`、`#{F11}`、`#{F12}`。

?> 2. 現在サポートする修飾キーは下記になります：`ALT`、`CTRL`、`SHIFT`、`WIN`（Windows）、`CMD`（macOS）。

?> 3. `デバイスドライバー`モードを利用するために、下記の条件を満たす必要があります：物理的にPS/2キーボードをWindowsシステムに接続する必要があります；BIOSのセーフモードでない状態で起動する必要があります；ロボットは管理者権限で起動する必要もあります；[.Net Framework 3.5](https://www.microsoft.com/en-us/download/details.aspx?id=21)をインストールする必要があります。

#### クリップボード読込み

WindowsもしくはmacOSのクリップボードの内容を取得します。

##### 入力引数
なし

##### 出力結果
クリップボード内容の文字列。

オペレーション引数
---

Windowsオペレーションの入力引数はユーザがオペレーション定義に使った変数になります。出力引数は同じ定義に設定した出力変数になります。
