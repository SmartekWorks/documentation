OS機能
===

OSのシステム機能を呼び出します。

システム待ち
---

一定的な時間（秒）を待ちます。

#### 入力引数
| 引数 | 説明
| ---- | ----
| 時間/タイムアウト（秒）   | 待ち時間。

#### 出力結果
なし


バッチ実行
---

バッチコマンドを実行します。

#### 入力引数
| 引数 | 説明
| ---- | ----
| コマンド  | 実行するコマンドライン<sup>1</sup>。例えば、`"my script.bat" arg1 arg2`。
| ワーキングディレクトリ | （省略可）実行のワーキングディレクトリ、例えば、`C:\RPA\myWorkingDir`。
| バックグランド  | （省略可）バックグラウンドで実行するかどうか、デフォルトは`false`。

#### 出力結果
コマンドの`stdout`の文字列。バックグラウンドで実行する場合に、プロセスの`pid`を出力します。

?> 1. コマンドに記述したパスにスペースを含めないようにご注意してください。

メッセージボックス
---

ユーザーにメッセージを提示するために、OSのメッセージボックスを表示させます<sup>1</sup>。`Windows`システムのみ。

#### 入力引数
| 引数 | 説明
| ---- | ----
| 内容  | メッセージボックスの内容、例えば、`I'm a message box!`。
| タイトル    | （省略可）メッセージボックスのタイトル、デフォルトは`Message Box`。

#### 出力結果
なし

?> 1. モデルタイプはメッセージボックスのため、ユーザーが明示的にメッセージボックを閉じらないと他の操作ができません。

通知表示
---

システムの通知を表示させます。OSによって、表示の仕方が違います。また追加の設定<sup>1</sup>も必要です。

#### 入力引数
| 引数 | 説明
| ---- | ----
| タイトル    | （省略可）通知のタイトル、デフォルトは`Notification`。
| メッセージ  | 通知メッセージの内容。

#### 出力結果
なし

?> 1. Windows 10以上の場合に、通知のソースはアプリケーションの絶対パスになります。もしアプリケーションのアイコンに変更したい場合に、`%ProgramData%\Microsoft\Windows\Start Menu\Programs`の配下に`SWATHubRobot.exe`のショットカットを作成する必要があります。

ログ書込み
---

ロボット`logs`配下のロボットログにメッセージを書込みます。

#### 入力引数
| 引数 | 説明
| ---- | ----
| ログレベル    | ログレベル、`info`、`warn`、`error`の値が利用できます。
| メッセージ  | メッセージの内容。

#### 出力結果
なし

キータイプ
---

アクティブのデスクトップエレメントに対して、キーをタイプします。

#### 入力引数

| 引数 | 説明
| ---- | ----
| テキスト  | 特殊キー以外のキー<sup>1</sup>のリスト。<br>複数キーが存在する場合に、順番にタイプします。
| 修飾キー | （省略可）テキストと組み合わせる特殊キー<sup>2</sup>。<br>例えば`SHIFT`、`ALT+CTRL`など。
| モード | （省略可）OSレベルの`キーボードイベント`が利用できない場合に、<br>`デバイスドライバー`<sup>3</sup>モードでドライバタイプすることが可能です。<br>デフォルトは`キーボードイベント`。

#### 出力結果

なし

?> 1. 現在対応している特殊キーは下記になります：`#{BACK}`、`#{DELETE}`、`#{ENTER}`、`#{TAB}`、`#{ESCAPE}`、`#{UP}`、`#{DOWN}`、`#{RIGHT}`、`#{LEFT}`、`#{HOME}`、`#{END}`、`#{PAGEUP}`、`#{PAGEDOWN}`、`#{F1}`、`#{F2}`、`#{F3}`、`#{F4}`、`#{F5}`、`#{F6}`、`#{F7}`、`#{F8}`、`#{F9}`、`#{F10}`、`#{F11}`、`#{F12}`。

?> 2. 現在サポートする修飾キーは下記になります：`ALT`、`CTRL`、`SHIFT`、`WIN`（Windows）、`CMD`（macOS）。

?> 3. `デバイスドライバー`モードを利用するために、下記の条件を満たす必要があります：物理的にPS/2キーボードをWindowsシステムに接続する必要があります；BIOSのセーフモードでない状態で起動する必要があります；ロボットは管理者権限で起動する必要もあります；[.Net Framework 3.5](https://www.microsoft.com/en-us/download/details.aspx?id=21)をインストールする必要があります。

クリップボード読込み
---

WindowsもしくはmacOSのクリップボードの内容を取得します。

#### 入力引数
なし

#### 出力結果
クリップボード内容の文字列。

クリップボード書込み
---

WindowsもしくはmacOSのクリップボードの内容を設定します。

#### 入力引数

| 引数 | 説明
| ---- | ----
| テキスト | 設定する文字列。

#### 出力結果

なし

資格情報取得
---

Windowsシステムの機密資格情報を取得します。`Windows`システムのみ。

#### 入力引数
| 引数 | 説明
| ---- | ----
| ターゲット  | 対象情報<sup>1</sup>インターネットもしくはネットワークのアドレス。

#### 出力結果
下記のキーを持つJSONマップ。
* `username`: プレーンテキストで記載したユーザ名。
* `password`: セキュアテキストで記載したパスワード<sup>2</sup>。


?> 1. 現在`Generic`タイプのみ対応しています。

?> 2. パスワードを利用する際に、自動的に復号化されますので、パスワードがプレーンテキストで表示や保存されることはありません。

スクリーン録画
---

Windowsのスクリーンを録画し、`mp4`フォーマットで保存します。`Windows`システムのみ。事前に[Screen Capture Recorder](https://github.com/rdp/screen-capture-recorder-to-video-windows-free/releases)をインストールしてください。

#### 入力引数
| 引数 | 説明
| ---- | ----
| ファイル  | 動画ファイルの保存パス。拡張子は`mp4`。
| 録画時間  | （省略可）録画の時間、単位は秒、デフォルトは`10`。
| フレームレート  | （省略可）録画で利用するフレームレート、デフォルトは`10`。
| リアルタイムバッファ  | （省略可）録画で利用するバッファサイズ、デフォルトは`128MB`。

#### 出力結果
録画プロセスのID。

拡張機能実行
---

SWATHubのために開発した拡張機能<sup>1</sup>を実行します。

#### 入力引数
| 引数 | 説明
| ---- | ----
| 拡張機能名  | 拡張機能の名前<sup>2</sup>。例えば、`baidu.ocr`。
| 入力データ  | 実行時に拡張機能に渡すJSONフォーマットの入力データ。デフォルトは`{}`。
| 変数名 | （省略可）拡張機能の戻り値を結果に格納する変数名。<br>指定しない場合に、結果を保存しません。

?> 1. SWATHubの拡張機能はJavaScriptで実現したJSファイルです。実行する前にロボットの拡張機能フォルダーにデプロイする必要があります。（Windowsの場合`%appdata%\SWATHubRobot\plugins`。Macの場合にユーザーデータの`Application Support/SWATHubRobot\plugins`。）

?> 2. 拡張機能の名前は拡張機能のJSファイルの名前。例えば、`baidu.ocr.js`の名前は`baidu.ocr`。

#### 出力結果
なし
