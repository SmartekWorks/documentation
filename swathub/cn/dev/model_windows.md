Windows模型
===

Windows模型是对所要操作的Windows应用进行建模，可以在模型上定义操作来模拟对应用窗口内控件进行鼠标和键盘动作。基于[Microsoft UI Automation](https://docs.microsoft.com/en-us/windows/win32/winauto/entry-uiauto-win32)，Windows模型可以支持多种类型的Windows应用，包括Win32，MFC，WPF，Metro UI等。

模型构建
---

在SWATHub中，我们通过模型获取器来获取Window应用的模型源文件，然后在模型之上，定义一系列相关的动作命令来构建Windows操作。

更具体的步骤参见[用户手册](../manual/design_model#windows模型)。

### Windows动作命令

Windows操作由一系列动作命令组成。Windows模型操作在运行时，操作中的命令将逐个执行。下面是当前支持的Windows动作命令。

#### 鼠标点击

鼠标点击指定的Windows控件。

##### 输入参数

| 参数 | 说明
| ---- | ----
| 选择器  | [Windows控件的选择器](#Windows控件的选择器)。
| 按钮  | 点击的鼠标按钮，使用`left`，`middle`或者`right`。
| 类型  | 点击的类型，使用`single`或者`double`。

##### 输出结果

无

#### 鼠标悬停

鼠标悬停到指定的Windows控件。

##### 输入参数

| 参数 | 说明
| ---- | ----
| 选择器  | [Windows控件的选择器](#Windows控件的选择器)。

##### 输出结果

无

#### 输入文本

对指定的Windows控件输入文本。

##### 输入参数

| 参数 | 说明
| ---- | ----
| 选择器  | [Windows控件的选择器](#Windows控件的选择器)。
| 文本  | 输入的文本，可以使用特殊键值，如`#{TAB}`，`#{UP}`，`#{ENTER}`等。

##### 输出结果

无

#### 获取文本

从指定的Windows控件中获取文本。该文本可以是控件的可编辑文本，也可以是控件的显示文本。

##### 输入参数

| 参数 | 说明
| ---- | ----
| 选择器  | [Windows控件的选择器](#Windows控件的选择器)。

##### 输出结果

定义一个变量来表示获取到的文本字符串

#### 激活控件

激活指定的Windows控件，并将其切换至前台。

##### 输入参数

| 参数 | 说明
| ---- | ----
| 选择器  | [Windows控件的选择器](#Windows控件的选择器)。

##### 输出结果

无

#### 键入热键

此命令将键盘键和修饰符发送到当前桌面屏幕中具有焦点的区域。

##### 输入参数

| 参数       | 解释
| ---------- | -----------
| 文本  | 要发送的热键。仅支持键盘上的那些键（除特殊键除外）。
| 特殊键 | （可选）修饰键<sup>1</sup>与鼠标单击一起按下的组合，如 `SHIFT`，`ALT+CTRL`。

##### 输出结果

无

?> 1. 目前支持以下修饰键：`SHIFT`、`CTRL`、`ALT`、`WIN` 和 `CMD`。

#### 获取剪贴板内容

此命令将从系统剪贴板中获取内容作为文本。

##### 输入参数

无

##### 输出结果

在这里，我们可以定义一个变量来存储剪贴板中的文本。

操作参数
---

Windows模型操作的输入参数由用户设在动作命令的输入参数中的变量构成；输出参数则是由所有动作命令中定义的输出变量构成。
