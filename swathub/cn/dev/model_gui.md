GUI模型
===

GUI模型是对所要操作的图形化交互应用进行建模，其中的操作则模拟对其窗口和控件上的鼠标和键盘操作。基于图像识别和OCR技术，SWATHub可以自动执行任何类型的桌面应用程序，甚至是Citrix环境和远程桌面应用程序。此外，在处理不提供其他自动化API的旧应用时，它也很有帮助，并且使用户能够通过简单的拖放轻松自动执行繁琐和重复性的任务。

GUI模型操作的缺点在于执行效率相对较低，同时比较依赖特定的GUI环境，不同电脑上运行的稳定性会有所下降。所以在存在其他自动化手段时，GUI模型往往不是最好的选择。

模型构建
---

在SWATHub中，我们通过定义GUI的图像和一系列相关的动作命令来构建GUI模型。

1. 我们需要使用操作系统级工具（如Windows中的`Print Screen`键和`MS Paint` 工具的组合）或任何其他可用的截屏工具来直接捕获桌面应用程序的图像<sup>1</sup> <sup>2</sup>。
1. 上传GUI图像到SWATHub设计平台，创建基于该图像的GUI模型。
1. 在GUI模型中通过用一系列的GUI动作命令来定义若干个GUI模型操作。


?> 1. 目前仅支持导入`png`图像。

?> 2. 在带有Retina屏幕的MAC上，请使用 [GUI Toolset](http://www.smartekworks.com/tools/SikuliX-1.1.2-Setup.zip) 来截取屏幕图像。使用系统的屏幕截图将无法被正确识别。

更具体的步骤参见[用户手册](../manual/design_model#gui模型)。其中可以定义的的GUI动作命令如下：

### GUI动作命令

GUI操作由一系列动作命令组成。GUI模型操作在运行时，操作中的命令将逐个执行。下面是当前支持的GUI动作命令。

#### 查找图像
此命令将尝试在当前桌面屏幕中查找和定位图像。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]`，用于指定屏幕上导入的矩形区域的图像。
| 变量  | （可选）定义一个变量来标识找到的图像。变量的值是运行时桌面屏幕上的JSON数组`[x,y,width,height]`。

##### 输出结果
无

#### 获取图像
此命令将尝试在当前桌面屏幕中查找和定位图像，然后以**Base64**格式返回。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]` 用于指定屏幕上导入的矩形区域的图像。
| 偏移值 | （可选）JSON数组`[x,y,width,height]`，用于指定相对于上图的偏移图像。<br>如果未设置，将返回上述图像。
| 变量  | （可选）定义一个变量来标识找到的图像。变量的值是从图像二进制数据转换的Base64字符串。

##### 输出结果
无

#### 点击图像
此命令将尝试在当前桌面屏幕中查找和定位图像，然后点击它。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]`，用于指定屏幕上导入的矩形区域的图像。
| 点击类型 | 单击操作的类型，`Single Click`、`Double Click`或者`Right Click`。
| 偏移值 | 可选）JSON数组`[x,y,width,height]`，用于指定相对于上图的偏移图像。<br>如果未设置，将返回上述图像。
| 特殊键 | （可选）修饰键<sup>1</sup>与鼠标单击一起按下的组合，如 `SHIFT`，`ALT+CTRL`。

##### 输出结果
无

?> 1. 目前支持以下修饰键：`SHIFT`、`CTRL`、`ALT`、`WIN` 和 `CMD`。

#### 悬停图像
此命令将尝试在当前桌面屏幕中查找和定位图像，然后将鼠标移到该图像上。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]`用于指定屏幕上导入的矩形区域的图像。
| 偏移值 | （可选）JSON数组`[x,y]` 用于指定鼠标悬停位置的协调，与上图相对。<br>如果未设置，鼠标将悬停在上图的中心。

##### 输出结果
无

#### 保存图像
此命令将尝试将获取到的**Base64**格式的图像，保存到本地文件。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 变量   | `获取图像`命令中保存图像的变量名。
| 文件   | 图像文件的本地路径名，如`C:\data\capture.png`。

##### 输出结果
无

#### 键入文本
此命令将在当前桌面屏幕中按焦点在区域中键入文本<sup>1</sup>。

##### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文本  | 要写入的文本。也支持[特殊键值](model_web#文本)。

##### 输出结果
无

?> 1. 为了支持任何语言的文本，现在我们利用**系统剪贴板**复制文本，然后从剪贴板粘贴到有焦点的区域。

#### 键入热键
此命令将键盘键和修饰符发送到当前桌面屏幕中具有焦点的区域。

##### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文本  | 要发送的热键。仅支持键盘上的那些键（除特殊键除外）。
| 特殊键 | （可选）修饰键<sup>1</sup>与鼠标单击一起按下的组合，如 `SHIFT`，`ALT+CTRL`。

##### 输出结果
无

?> 1. 目前支持以下修饰键：`SHIFT`、`CTRL`、`ALT`、`WIN` 和 `CMD`。

#### 存在图像
此命令将尝试检查当前桌面屏幕中是否存在图像，并返回检查结果。

##### 输入参数
| 参数      | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]` 用于指定屏幕上导入的矩形区域的图像。
| 变量  | （可选）定义一个变量来保存检查结果的变量名，结果为`true`或`false`。

##### 输出结果
无

#### 获取OCR文本
此命令将查找并查找当前桌面屏幕中的矩形区域，然后使用OCR技术识别其中的文本<sup>1</sup>。

##### 输入参数
| 参数       | 解释
| ---------- | -----------
| 图像  | JSON数组`[x,y,width,height]` 用于指定屏幕上导入的矩形区域的图像。
| 偏移值 |（可选）JSON数组`[x,y,width,height]`，用于指定相对于上图的偏移图像。<br>如果未设置，将返回上述图像。
| 变量  | （可选）定义一个变量来存储识别的文本。

##### 输出结果
无

?> 1. 自带OCR目前仅支持**英数字**字符。

#### 获取剪贴板内容
此命令将从系统剪贴板中获取内容作为文本。

##### 输入参数
| 参数       | 解释
| ---------- | -----------
| 变量  | （可选）定义一个变量来存储识别的文本。

##### 输出结果
无。

操作参数
---

GUI模型操作的输入参数由用户设在动作命令的输入参数中的变量构成；输出参数则是由所有动作命令中定义的输出变量构成。
