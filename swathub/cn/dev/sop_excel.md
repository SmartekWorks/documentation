Excel
===

系统操作中的Excel组件，可以读取和写入Excel文档，并支持以下操作：

读取单元格
---

此操作可以从Excel文件读取特定单元格，并返回字符串。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径。例如`C:\RPA\data.xlsx`<sup>1</sup>
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格     | 要读取的单元格的指示器，例如`A1`， `B2`。

#### 输出结果
所选单元格的字符串值。

?> 1. Windows 上支持前进斜杠和反斜杠，例如， `C:\RPA\data.xlsx` 或者 `C:/RPA/data.xlsx`。

写入单元格
---

此操作可以将字符串写入Excel文件的特定单元格，并返回布尔值。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格     | 要写入的单元格的指示器，例如`A1`，`B2`。
| 数据    | 要设置单元格的字符串值，例如`HelloWorld!`。

#### 输出结果
布尔类型，用于指示操作是否成功。

读取单元格区域
---

此操作可以从Excel文件中读取范围，并返回一个二维字符串数组。 

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格区域    | 要读取的范围的指示器，例如`A1:D4`。空白字符串表示整个工作表。

#### 输出结果
字符类型的二维数组<sup>1</sup>。

?> 1. 范围内的空白行也将读取并返回为一个带空字符串 `[""]`的数组。 

写入单元格区域
---

此操作可以将二维字符串数组写入Excel文件的范围，并返回布尔值。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格     | 范围内起始单元的指示器，例如`A2`。
| 数据    | 要写入数据的数组，例如来自内部变量 `@{dataTable}`。

`dataTable` 是一个二维数组，如下所示：
```json
[
  ["A1 Value", "B1 Value", "C1 Value"],
  ["A2 Value", "B2 Value", "C2 Value"],
  ["A3 Value", "B3 Value", "C3 Value"],
]
```

#### 输出结果
布尔类型，用于指示操作是否成功。

执行Excel宏
---

此操作可以执行Excel宏，并返回字符串（如有返回）。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 宏名称   | Excel宏的名称，例如`myFunction`。
| 参数列表  | 宏参数的数组，例如`["arg1", "arg2", "arg3"]`。现在，最多支持10个参数。

#### 输出结果
宏返回的字符串。

复制表单
---

此操作可以复制单个表单到其他Excel文件或自身。仅支持`Windows`操作系统。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 源文件     | Excel源文件的完整路径，例如`C:/RPA/source.xlsx`。
| 源表单     | Excel源表单的名称，例如`Sheet1`。
| 目标文件   | Excel目标文件的完整路径，例如`C:/RPA/destination.xlsx`。
| 目标表单   | Excel目标表单的名称，例如`Sheet2`。

#### 输出结果
布尔类型，用于指示操作是否成功。

获取表单名
---

此操作可以获取Excel文件中所有的表单名称。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件      | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。

#### 输出结果
数组类型，所有表单的名称。

设置密码
---

此操作可以对于Excel文件进行加密和解密操作。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件      | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 解密密码  | （可选）Excel文件的解密密码，如存在则进行解密操作。
| 加密密码  | （可选）Excel文件的加密密码，如存在则进行加密操作。

#### 输出结果
布尔类型，用于指示操作是否成功。

读取单元格公式
---

此操作可以从Excel文件读取特定单元格的公式，并返回A1类型的公式字符串，例如`=A1+B1`。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径。例如`C:\RPA\data.xlsx`。
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格     | 要读取的单元格的指示器，例如`A1`， `B2`。

#### 输出结果
所选单元格的公式字符串，包含`=`号。

写入单元格公式
---

此操作可以将A1类型的公式写入Excel文件的特定单元格，并返回布尔值。

#### 输入参数
| 参数       | 解释
| ---------- | -----------
| 文件     | Excel文件的完整路径，例如`C:/RPA/data.xlsx`。
| 表单    | Excel工作表的名称，例如`Sheet1`。
| 单元格     | 要写入的单元格的指示器，例如`A1`，`B2`。
| 数据    | 要设置单元格的字符串值，例如`=A1+B1`。

#### 输出结果
布尔类型，用于指示操作是否成功。